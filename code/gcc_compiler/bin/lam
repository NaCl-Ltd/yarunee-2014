#!/usr/bin/env ruby
$LOAD_PATH.unshift "#{__dir__}/../lib"
require 'lam'

if ARGV.size == 0
  puts "usage: lam foo.lam"
  exit
end

begin
  prelude = File.read("#{__dir__}/../lam/prelude.lam")
  src = ARGF.read
  puts Lam.compile(prelude + src)
rescue Lam::Error => ex
  warn ex.message
rescue RParsec::ParserException => ex
  warn "パースエラー: #{ex.message}"
end

